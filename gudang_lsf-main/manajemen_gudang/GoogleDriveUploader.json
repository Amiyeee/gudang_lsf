{"files":[{"id":"0bdb7211-bea7-4d58-83f8-3113da44af02","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Jakarta\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE_ANONYMOUS\"\n  }\n}"},{"id":"bfacc5a3-d0d0-4802-8487-91acccdcceae","name":"Code","type":"server_js","source":"function doPost(e) {\n  try {\n    // Konfigurasi ID Folder Google Drive\n    var folderId \u003d \"1__hBKNSvzm7xbnCMW7UpFGU6z00kfjgJ\"; // Ganti dengan ID folder Google Drive Anda\n    var folder \u003d DriveApp.getFolderById(folderId);\n\n    // Validasi parameter utama\n    if (!e.parameter.files) {\n      throw new Error(\"Parameter tidak lengkap. Pastikan \u0027files\u0027 disertakan sebagai JSON array.\");\n    }\n\n    // Parse file data (dikirim dalam format JSON array)\n    var files \u003d JSON.parse(e.parameter.files);\n\n    // Array untuk menyimpan hasil\n    var uploadResults \u003d [];\n\n    files.forEach(function (file) {\n      // Validasi data file\n      if (!file.fileData || !file.mimeType || !file.fileName) {\n        throw new Error(\"Parameter tidak lengkap untuk salah satu file. Pastikan fileData, mimeType, dan fileName disertakan.\");\n      }\n\n      // Decode file data\n      var blob \u003d Utilities.newBlob(Utilities.base64Decode(file.fileData), file.mimeType, file.fileName);\n\n      // Validasi MIME Type (Hanya izinkan PDF dan Excel)\n      var allowedMimeTypes \u003d [\n        \"application/pdf\",\n        \"application/vnd.ms-excel\",\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\n      ];\n      if (!allowedMimeTypes.includes(blob.getContentType())) {\n        uploadResults.push({\n          name: file.fileName,\n          success: false,\n          message: \"Tipe file tidak didukung.\"\n        });\n        return; // Lanjutkan ke file berikutnya\n      }\n\n      // Cek ukuran file (misal, batasi 10MB)\n      if (blob.getBytes().length \u003e 10 * 1024 * 1024) {\n        uploadResults.push({\n          name: file.fileName,\n          success: false,\n          message: \"Ukuran file terlalu besar. Maksimal 10MB.\"\n        });\n        return; // Lanjutkan ke file berikutnya\n      }\n\n      // Simpan file ke Google Drive\n      var driveFile \u003d folder.createFile(blob);\n      driveFile.setSharing(DriveApp.Access.ANYONE_WITH_LINK, DriveApp.Permission.VIEW);\n\n      // Tambahkan ke hasil sukses\n      uploadResults.push({\n        name: file.fileName,\n        success: true,\n        url: driveFile.getUrl()\n      });\n    });\n\n    // Kembalikan hasil JSON untuk semua file\n    return ContentService.createTextOutput(JSON.stringify({\n      success: true,\n      results: uploadResults\n    })).setMimeType(ContentService.MimeType.JSON);\n\n  } catch (error) {\n    // Logging kesalahan\n    console.error(\"Error saat memproses unggahan: \", error);\n\n    // Kembalikan respon JSON untuk error\n    return ContentService.createTextOutput(JSON.stringify({\n      success: false,\n      message: error.toString()\n    })).setMimeType(ContentService.MimeType.JSON);\n  }\n}\n"}]}